<Application x:Class="shop_clothes.App"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:local="clr-namespace:shop_clothes"
             StartupUri="MainWindow.xaml" ShutdownMode="OnExplicitShutdown" 
             >
    
        <Application.Resources>
            
            <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="/Resources/Languages/Strings.ru-RU.xaml"/>
                <ResourceDictionary Source="/Resources/Styles/LightTheme.xaml"/>
                <ResourceDictionary Source="/Dictionary.xaml"/>
            </ResourceDictionary.MergedDictionaries>
           
            <BitmapImage x:Key="AppIcon" UriSource="Resources/app_icon.ico"/>
                
            <DataTemplate x:Key="ProductTemplate">
                <Border Width="200" Height="250" Margin="5" Padding="10"
        BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1">
                    <Border.Style>
                        <Style TargetType="Border">
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding discount}" Value="0">
                                    <Setter Property="Background" Value="{DynamicResource CardBackgroundBrush}"/>
                                </DataTrigger>
                            </Style.Triggers>
                            <Setter Property="Background" Value="{DynamicResource CardBackgroundDiscountBrush}"/>
                            <!-- Желтоватый фон для товаров со скидкой -->
                        </Style>
                    </Border.Style>
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="150"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <!-- Контейнер для изображения с анимацией -->
                        <Border Grid.Row="0" ClipToBounds="True">
                            <!-- Изображение товара -->
                            <Image x:Name="productImage" Grid.Row="0" Source="{Binding imagePath}" Stretch="Uniform" RenderTransformOrigin="0.5,0.5">
                                <Image.RenderTransform>
                                    <ScaleTransform x:Name="imageScale" ScaleX="1" ScaleY="1"/>
                                </Image.RenderTransform>
                                <Image.Effect>
                                    <DropShadowEffect x:Name="imageShadow" ShadowDepth="0" Opacity="0"/>
                                </Image.Effect>

                                <!-- EventTrigger для анимации при наведении -->
                                <Image.Triggers>
                                    <EventTrigger RoutedEvent="MouseEnter">
                                        <BeginStoryboard>
                                            <Storyboard>
                                                <!-- Анимация увеличения -->
                                                <DoubleAnimation Storyboard.TargetName="imageScale"
                                       Storyboard.TargetProperty="ScaleX"
                                       To="1.1" Duration="0:0:0.3"/>
                                                <DoubleAnimation Storyboard.TargetName="imageScale"
                                       Storyboard.TargetProperty="ScaleY"
                                       To="1.1" Duration="0:0:0.3"/>
                                                <!-- Анимация тени -->
                                                <DoubleAnimation Storyboard.TargetName="imageShadow"
                                       Storyboard.TargetProperty="Opacity"
                                       To="0.5" Duration="0:0:0.3"/>
                                                <DoubleAnimation Storyboard.TargetName="imageShadow"
                                       Storyboard.TargetProperty="ShadowDepth"
                                       To="5" Duration="0:0:0.3"/>
                                            </Storyboard>
                                        </BeginStoryboard>
                                    </EventTrigger>

                                    <EventTrigger RoutedEvent="MouseLeave">
                                        <BeginStoryboard>
                                            <Storyboard>
                                                <!-- Анимация возврата к исходному состоянию -->
                                                <DoubleAnimation Storyboard.TargetName="imageScale"
                                       Storyboard.TargetProperty="ScaleX"
                                       To="1" Duration="0:0:0.3"/>
                                                <DoubleAnimation Storyboard.TargetName="imageScale"
                                       Storyboard.TargetProperty="ScaleY"
                                       To="1" Duration="0:0:0.3"/>
                                                <DoubleAnimation Storyboard.TargetName="imageShadow"
                                       Storyboard.TargetProperty="Opacity"
                                       To="0" Duration="0:0:0.3"/>
                                                <DoubleAnimation Storyboard.TargetName="imageShadow"
                                       Storyboard.TargetProperty="ShadowDepth"
                                       To="0" Duration="0:0:0.3"/>
                                            </Storyboard>
                                        </BeginStoryboard>
                                    </EventTrigger>
                                </Image.Triggers>
                            </Image>
                        </Border>

                        <!-- Название -->
                        <TextBlock Grid.Row="1" Text="{Binding shortName}" FontWeight="Bold"/>

                        <!-- Цена -->
                        <StackPanel Grid.Row="2" Orientation="Horizontal">
                            <TextBlock Text="{Binding FinalPrice, StringFormat=C}"/>
                            <TextBlock Text="{Binding discount, StringFormat={}{0}%}" 
                       Margin="5,0,0,0"
                       >
                                <TextBlock.Style>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="Foreground" Value="Green"/>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding discount}" Value="0">
                                                <Setter Property="Visibility" Value="Hidden"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBlock.Style>
                            </TextBlock>
                        </StackPanel>

                        <!-- Категория -->
                        <TextBlock Grid.Row="3" Text="{Binding Category.name}" Foreground="{DynamicResource TextCategoryColorBrush}"/>

                        <!-- Кнопки -->
                        <StackPanel Grid.Row="5" Orientation="Horizontal" HorizontalAlignment="Center">
                            <Button  Style = "{StaticResource DetailsButtonStyle}" 
                    Command="{Binding DataContext.ViewDetailsCommand, RelativeSource={RelativeSource AncestorType=ItemsControl}}"
                    CommandParameter="{Binding}"/>

                            <Button Style="{StaticResource AddToCartButtonStyle}"
                    Content="{DynamicResource IntoBasketButton}"
                    Command="{Binding DataContext.AddToCartCommand, RelativeSource={RelativeSource AncestorType=ItemsControl}}"
                    CommandParameter="{Binding}">
                                
                            </Button>
                        </StackPanel>
                    </Grid>
                </Border>
            </DataTemplate>
        </ResourceDictionary>
            

    </Application.Resources>
   
</Application>
    
